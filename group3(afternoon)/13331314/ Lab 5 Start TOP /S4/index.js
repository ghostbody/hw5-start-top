// Generated by LiveScript 1.3.1
(function(){
  var robot2, clickNext, clickOnAButton, displayTheRedBadge, disableAllOtherButtons, getNumberFromTheServer, enableOtherButtons, clickOnTheBubble, initialAtplus;
  $(function(){
    var buttons, bubble, icon;
    buttons = $('#control-ring li');
    bubble = $('#info-bar');
    icon = $('.apb');
    buttons.click(function(){
      clickOnAButton(this);
    });
    bubble.click(function(){
      clickOnTheBubble(bubble);
    });
    icon.mouseover(function(){
      initialAtplus();
    });
    return icon.click(function(){
      robot2();
    });
  });
  robot2 = function(){
    var sequence, sumArea, cursor;
    sequence = ["A", "B", "C", "D", "E"];
    sequence.sort(function(){
      return 0.5 - Math.random();
    });
    sumArea = $('.sum');
    sumArea.html(sequence.join(', '));
    cursor = 0;
    $('#button .apb').click(function(){
      clickNext(cursor, sequence);
    });
  };
  clickNext = function(cursor, sequence){
    var bubble, buttons, index, theButton;
    bubble = $('#info-bar');
    buttons = $('#control-ring li');
    if (cursor === sequence.length) {
      bubble.click();
    } else {
      index = sequence[cursor].charCodeAt() - 'A'.charCodeAt();
      cursor++;
      theButton = buttons[index];
      displayTheRedBadge(theButton);
      disableAllOtherButtons(theButton);
      $.get('/', function(data){
        $(theButton).children('.unread').html(data);
        enableOtherButtons(theButton);
        $(theButton).css("background-color", "#7E7E7E");
        $(theButton).attr("state", "clicked");
        clickNext(cursor, sequence);
      });
    }
  };
  clickOnAButton = function(theButton){
    var disable;
    disable = $(theButton).attr("state");
    if (disable !== "disable" && disable !== "clicked") {
      displayTheRedBadge(theButton);
      disableAllOtherButtons(theButton);
      getNumberFromTheServer(theButton);
      $(theButton).attr("state", "clicked");
    }
  };
  displayTheRedBadge = function(theButton){
    var badge;
    badge = $(theButton).children('.unread');
    badge.css('display', 'block').html('...');
  };
  disableAllOtherButtons = function(theButton){
    var buttons, i$, len$, button, clicked;
    buttons = $('#control-ring li');
    for (i$ = 0, len$ = buttons.length; i$ < len$; ++i$) {
      button = buttons[i$];
      if (button !== theButton) {
        clicked = $(button).attr("state");
        if (clicked !== "clicked") {
          $(button).attr("state", "disable");
          $(button).css("background-color", "#7E7E7E");
        }
      }
    }
  };
  getNumberFromTheServer = function(theButton){
    return $.get('/', function(data){
      $(theButton).children('.unread').html(data);
      enableOtherButtons(theButton);
      $(theButton).css("background-color", "#7E7E7E");
    });
  };
  enableOtherButtons = function(theButton){
    var buttons, i$, len$, button, clicked;
    buttons = $('#control-ring li');
    for (i$ = 0, len$ = buttons.length; i$ < len$; ++i$) {
      button = buttons[i$];
      if (button !== theButton) {
        clicked = $(button).attr("state");
        if (clicked !== "clicked") {
          $(button).attr("state", "");
          $(button).css("background-color", "#192E89");
        }
      }
    }
  };
  clickOnTheBubble = function(bubble){
    var sumArea, sum, numbers, i$, len$, number;
    sumArea = $('.sum');
    sum = 0;
    numbers = $(".unread");
    for (i$ = 0, len$ = numbers.length; i$ < len$; ++i$) {
      number = numbers[i$];
      if ($(number).html() !== "" || $(number).html() !== "...") {
        sum += parseInt($(number).html());
      }
    }
    sumArea.html(sum);
  };
  initialAtplus = function(){
    var bubble, badge, buttons;
    bubble = $('.sum');
    badge = $('.unread');
    buttons = $('#control-ring li');
    $(buttons).attr("state", "");
    $(buttons).css("background-color", "#192E89");
    badge.css('display', 'none').html('');
    bubble.html('');
  };
}).call(this);
